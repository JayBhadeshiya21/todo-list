{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///D:/Todo-list/todo-list/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma =\r\n    globalForPrisma.prisma ||\r\n    new PrismaClient({\r\n        log: ['query'],\r\n    });\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACT,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACb,KAAK;QAAC;KAAQ;AAClB;AAEJ,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///D:/Todo-list/todo-list/app/api/login/page.tsx"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/db';\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const { email, password } = await req.json();\r\n\r\n    const user = await prisma.users.findFirst({\r\n      where: {\r\n        Email: email,\r\n        PasswordHash: password, // (hashed in real apps)\r\n      },\r\n      include: {\r\n        userroles: {\r\n          include: {\r\n            roles: true,\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: 'Invalid credentials' }, { status: 401 });\r\n    }\r\n\r\n    // Check ADMIN role\r\n    const isAdmin = user.userroles.some(\r\n      ur => ur.roles.RoleName === 'ADMIN'\r\n    );\r\n\r\n    if (!isAdmin) {\r\n      return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n    }\r\n\r\n    // Set admin session cookie\r\n    const res = NextResponse.json({ message: 'Login successful' });\r\n    res.cookies.set('adminId', user.UserID.toString(), {\r\n      httpOnly: true,\r\n      path: '/',\r\n    });\r\n\r\n    return res;\r\n  } catch (err) {\r\n    return NextResponse.json({ error: 'Login failed' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAE1C,MAAM,OAAO,MAAM,mHAAM,CAAC,KAAK,CAAC,SAAS,CAAC;YACxC,OAAO;gBACL,OAAO;gBACP,cAAc;YAChB;YACA,SAAS;gBACP,WAAW;oBACT,SAAS;wBACP,OAAO;oBACT;gBACF;YACF;QACF;QAEA,IAAI,CAAC,MAAM;YACT,OAAO,8IAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,mBAAmB;QACnB,MAAM,UAAU,KAAK,SAAS,CAAC,IAAI,CACjC,CAAA,KAAM,GAAG,KAAK,CAAC,QAAQ,KAAK;QAG9B,IAAI,CAAC,SAAS;YACZ,OAAO,8IAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QAEA,2BAA2B;QAC3B,MAAM,MAAM,8IAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmB;QAC5D,IAAI,OAAO,CAAC,GAAG,CAAC,WAAW,KAAK,MAAM,CAAC,QAAQ,IAAI;YACjD,UAAU;YACV,MAAM;QACR;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,OAAO,8IAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}